___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Criteo OneTag Custom Template",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d\u003d"
  },
  "description": "Criteo OneTag template with auto event detection feature.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "accountId",
    "displayName": "Criteo Partner ID",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "deviceType",
    "displayName": "Device Type",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "userEmail",
    "displayName": "User Email (Optional)",
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "currencyCode",
    "displayName": "Currency Code (Optional)",
    "simpleValueType": true
  },
  {
    "type": "SELECT",
    "name": "eventDetection",
    "displayName": "Select Event Detection Method",
    "macrosInSelect": false,
    "selectItems": [
      {
        "value": "enhancedEcommerce",
        "displayValue": "Auto Detect Using Enhanced Ecommerce Object"
      },
      {
        "value": "manualSelection",
        "displayValue": "Set Triggers Manually"
      }
    ],
    "simpleValueType": true,
    "alwaysInSummary": false
  },
  {
    "type": "RADIO",
    "name": "userEventType",
    "displayName": "Criteo Tracker Event",
    "radioItems": [
      {
        "value": "viewHome",
        "displayValue": "Home Page"
      },
      {
        "value": "impressions",
        "displayValue": "Listing",
        "subParams": [
          {
            "type": "TEXT",
            "name": "productIds",
            "displayName": "Product Array",
            "simpleValueType": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ]
      },
      {
        "value": "detail",
        "displayValue": "Product",
        "subParams": [
          {
            "type": "TEXT",
            "name": "productId",
            "displayName": "Product ID",
            "simpleValueType": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ]
      },
      {
        "value": "checkout",
        "displayValue": "Basket",
        "subParams": [
          {
            "type": "TEXT",
            "name": "basketObject",
            "displayName": "Basket Object Array",
            "simpleValueType": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ]
      },
      {
        "value": "purchase",
        "displayValue": "Transaction",
        "subParams": [
          {
            "type": "TEXT",
            "name": "transactionId",
            "displayName": "Transaction ID",
            "simpleValueType": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "transactionObject",
            "displayName": "Transaction Object Array",
            "simpleValueType": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          },
          {
            "type": "TEXT",
            "name": "dedup",
            "displayName": "Deduplication Parameter (Optional)",
            "simpleValueType": true
          }
        ]
      }
    ],
    "simpleValueType": true,
    "enablingConditions": [
      {
        "paramName": "eventDetection",
        "paramValue": "enhancedEcommerce",
        "type": "NOT_EQUALS"
      }
    ]
  },
  {
    "type": "CHECKBOX",
    "name": "addCustomParameters",
    "checkboxText": "Add Custom Parameters",
    "simpleValueType": true,
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "paramTable",
        "displayName": "Add new rows for each custom parameter.",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "Name",
            "name": "paramName",
            "type": "TEXT",
            "isUnique": true
          },
          {
            "defaultValue": "",
            "displayName": "Value",
            "name": "paramValue",
            "type": "TEXT"
          }
        ],
        "enablingConditions": [
          {
            "paramName": "addCustomParameters",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

/* @TODO
 * 1. Deduplication cookie management
 * 2. Multiple partner id support from user fields
 * 3. Check if possible to copy events from FB Pixel
 * 4. Optionally double hash email with sha256 if not plain text
 * 5. Enhanced error logging feature
 * 6. Query permissions before trying to run script
 * 7. Add vertical specific parameter templates
 * 8. Add search events support
 * 9. Add Flush event feature for multiple partner setup w/ different setup
 * 10. Change viewHome fallback logic
 * 11. When automatic detection is selected, enable user to choose a variable (!?)
 * 12. Add help text for each field
 * 13. Detect d-m-t without user input
 * 14. Fire home page event if path=/|/index.(html|asp|aspx)
*/

/*
 * APIs
 */
const logToConsole = require('logToConsole');
const copyFromDataLayer = require('copyFromDataLayer');
const createQueue = require('createQueue');
const callInWindow = require('callInWindow');
const injectScript = require('injectScript');
const setInWindow = require('setInWindow');
const copyFromWindow = require('copyFromWindow');

/*
 *  Tag configuration/user inputs
 */
const criteoAccountId = data.accountId;
const deviceType = data.deviceType;
const userEmail = data.userEmail || "";
const currencyCode = data.currencyCode;
const eventDetectionMethod = data.eventDetection;
const userEventType = data.userEventType;
const viewItemProductId = data.productId;
const viewListProductIds = data.productIds;
const viewBasketObject = data.basketObject;
const trackTransactionId = data.transactionId;
const trackTransactionObject = data.transactionObject;
const addCustomParameters = data.addCustomParameters;
const customParamList = data.paramTable;
const deduplicationValue = data.dedup;

/*
 * Checks if product data is inside an array
 * Not used now, needs to be updated.
 */
const isArray = (toCheck) => {
  
  let arr = callInWindow('toString.call', toCheck) === '[object Array]';
  
  let out = {
	valid: false,
    msg: ''
  };
  
  if (arr) {
  
    if (!toCheck.length) {
  
      out['msg'] = 'Array with zero elements.';
    
      return out;
    }

    out['valid'] = true;
    out['msg'] = toCheck[0];

    return out;
  }
  
  out['msg'] = 'Not an array.';
  
  return out;
};

/*
 * Ref: https://stackoverflow.com/questions/24221803/javascript-access-object-multi-level-property-using-variable#answer-24221895
 * Not used now, needs to be updated
 */
const validateObjectFormat = (eeObject, objPath) => {
 let targetPath = objPath.split('.');
 let current = eeObject;
 let nextPath = '';
 let prevPath = '[ecommerce object]';
 let searchFor = '';
 let pathLength = objPath.length + 1;
 while (pathLength) {
   if (!current) {
     return false;
   }
   if (searchFor === 'list') {
     searchFor = '';
     let arrayCheck = isArray(current);
     if (arrayCheck.valid) {
       current = arrayCheck.msg;
     } else {
       onFailure(arrayCheck.msg);
       return false;
     }
   }
   nextPath = targetPath.shift();
   prevPath += '[' + nextPath + ']';
   nextPath = nextPath === '[]' ? (searchFor = 'list', pathLength--, targetPath.shift()) : nextPath;
   current = current[nextPath];
   pathLength--;
 }
 return true;
};

/*
 * Checks if there is any of 4 enhanced ecommerce events present in dataLayer,
 * Otherwise return viewHome event.
 */
const getEnhancedEcommerceEvent = (eeObject) => {

  const enhancedEcommerceEventList = ['detail', 'impressions', 'checkout', 'purchase'];

  let matchingEvent = null;

  for (var i = 0; i < enhancedEcommerceEventList.length; i++) {

    if (eeObject.hasOwnProperty(enhancedEcommerceEventList[i])) {
      
      matchingEvent = enhancedEcommerceEventList[i];
      break;
    }
  }

  return matchingEvent || 'viewHome';
};

/*
 * Extract product info from checkout & transaction enh. ecommerce events.
 */
const getBasketDetails = (eeObject, eeEvent) => {

  //['id', 'price', 'quantity'].forEach(prop => validateObjectFormat(eeObject, eeEvent + '.[].products.' + prop));

  return eeObject[eeEvent].products.map((product) => {
    return {
      id: product.id || false,
      price: (product.price || '1.00'),
      quantity: (product.quantity || 1)
    };
  }).filter(p => p.id);
};

/*
 *  Map enhanced ecommerce events to Criteo events.
 */
const eventMapper = {
  detail: (eeObject, sourceType) => {
    //validateObjectFormat(eeObject, 'detail.[].products.id');
    return {
      'event': 'viewItem',
      'item': sourceType === 'ee' ? eeObject.detail.products[0].id : viewItemProductId
    };
  },
  impressions: (eeObject, sourceType) => {
    //validateObjectFormat(eeObject, '[].impressions.id');
    return {
      'event': 'viewList',
      'item': (sourceType === 'ee' ? eeObject.impressions.map((p) => {return p.id || false;}).filter(p => p) : viewListProductIds).slice(0,3)
    };
  },
  checkout: (eeObject, sourceType) => {
    const eventObject = {
      'event': 'viewBasket',
      'item': sourceType === 'ee' ? getBasketDetails(eeObject, 'checkout') : viewBasketObject
    };
    if (currencyCode) {
      eventObject.currency = currencyCode.toUpperCase();
    }
    return eventObject;
  },
  purchase: (eeObject, sourceType) => {
    //validateObjectFormat(eeObject, 'purchase.actionField.id');
    const eventObject = {
      'event': 'trackTransaction',
      'id': sourceType === 'ee' ? eeObject.purchase.actionField.id : trackTransactionId,
      'item': sourceType === 'ee' ? getBasketDetails(eeObject, 'purchase') : trackTransactionObject
    };
    if (currencyCode) {
      eventObject.currency = currencyCode.toUpperCase();
    }
    return eventObject;
  },
  viewHome: () => {
    return {
      'event': 'viewHome'
    };
  }
};

/*
 * Event to be sent
 */
let targetEvent = '';

/*
 * Keeps track of Criteo events sent inside current window.
 */
const reportEvent = (eventList, newEvent) => {

  const newList = eventList ? eventList.concat([newEvent]) : [newEvent];

  setInWindow('__sentCriteoEventsInWindow', newList, true);
};

/*
 * Checks if viewHome sent before in current window.
 */
const checkViewHomeEvent = (eventList) => {
  return eventList.indexOf('viewHome') > -1 ? true : false;
};

/*
 * Log with label
 */
const logger = (msg) => {

  logToConsole('Criteo_OneTag2_CT_DEBUGGER:: >', msg);
};


/*
 * Custom success fn.
 */
const onSuccess = (msg) => {
  
  reportEvent(sentCriteoEventsInWindow, targetEvent);

  logger(msg || 'Tag complete.');
  
  data.gtmOnSuccess();
};

/*
 * Custom failure fn.
 */
const onFailure = (msg) => {

  logger(msg || 'Tag did not send any events.');

  data.gtmOnFailure();
};

/*
 * Script runner
 */
const runScript = () => {

  injectScript('https://static.criteo.net/js/ld/ld.js', onSuccess, onFailure, 'criteoOneTag2CT');
};

/*
 * Pushes event data to Criteo's data layer.
 */
const buildCriteoEvent = (eventType, eeObject, sourceType, mapper, cb) => {

  var targetCriteoEvent = mapper[eventType](eeObject, sourceType);
  
  if (addCustomParameters && customParamList) {

    customParamList.forEach(e => {
      targetCriteoEvent[e.paramName] = e.paramValue;
    });

  } 
  
  if (eventType === 'purchase' && deduplicationValue) {

    if (['1', '0', 0, 1].indexOf(deduplicationValue) > -1) {
    
      targetCriteoEvent['deduplication'] = deduplicationValue;
    } else {
    
      logger('Warning: Deduplication parameter needs to be one of [1, 0]');
    }
  }

  targetCriteoEvent['tms'] = "gtm-criteo-template";

  callInWindow('criteo_q.push',
    {'event': 'setAccount', 'account': criteoAccountId},
    {'event': 'setEmail', 'email': userEmail},
    {'event': 'setSiteType', 'type': deviceType},
    targetCriteoEvent
  );
  targetEvent = eventType;

  cb();
};

/*
 * Create a list of Criteo events that are going to be sent.
 * No override.
 */
setInWindow('__sentCriteoEventsInWindow', []);

/*
 * Get the list of Criteo events.
 */
const sentCriteoEventsInWindow = copyFromWindow('__sentCriteoEventsInWindow');

/*
 * Initialize Criteo's data layer.
 * Will not use the pusher fn. Sending multiple events in current window is easier with seperate criteo_q.push calls
 */
const criteoLayer = createQueue('criteo_q');

/*
 * Build the event.
 */
if (eventDetectionMethod !== 'enhancedEcommerce') {
  // Call event with user inputs.
  buildCriteoEvent(
    userEventType, null, 'ms', eventMapper, runScript
  );
} else {
  // Using version 1 to get the latest push.
  const enhancedEcommerceObject = copyFromDataLayer('ecommerce', 1);
  // If no enh. ecommerce object
  if (!enhancedEcommerceObject) {

    onFailure('Enhanced e-commerce object inside dataLayer is undefined.');
  } else {
    // Get enh. ecommerce event
    const autoEventType = getEnhancedEcommerceEvent(enhancedEcommerceObject);
    // Check if event is viewHome to prevent duplicate calls
    // Since its the default/fallback event if enh. ecommerce event is other than the four accepted ones.
    if (autoEventType === 'viewHome') {

      let viewHomeSentBefore = checkViewHomeEvent(sentCriteoEventsInWindow);

      if (viewHomeSentBefore) {
        // Already sent viewHome, quit in order to prevent duplicates.
        onFailure('Window already sent viewHome event before. Duplicate home page events blocked.');
      } else {
        // First viewHome event in window, run the script.
        buildCriteoEvent(
          autoEventType, enhancedEcommerceObject, 'ee', eventMapper, runScript
        );
      }
    } else {
      // One of ['detail', 'impressions', 'checkout', 'purchase'].
      buildCriteoEvent(
        autoEventType, enhancedEcommerceObject, 'ee', eventMapper, runScript
      );
    }
  }
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "criteo_q"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "__sentCriteoEventsInWindow"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "toString"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "criteo_q.push"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "ecommerce"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://static.criteo.net/js/ld/ld.js"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 11/04/2020, 01:01:13


